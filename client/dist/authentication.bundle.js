!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=36)}({0:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(1);class r{constructor(t,e={}){this._component=i.a.parse(this._base(e)),this._tag="#"+e.id,this._parentSelector=t,this._info=e,this._init(),document.querySelector(this._parentSelector).appendChild(this._component)}_init(){this._initListeners(this._info.listeners)}_initListeners(t){t&&t.forEach(t=>{this._component.addEventListener(t.type,t.action)})}_base(t){throw new Error("the method fieldsTempalte must be implemented")}}},1:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));class i{static parse(t){return(new DOMParser).parseFromString(t,"text/html").documentElement.querySelector("body").firstChild}}},11:function(t,e,n){"use strict"},2:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));class i{constructor(t,e){this._type=t,this._action=e}get type(){return this._type}get action(){return this._action}}},36:function(t,e,n){"use strict";n.r(e);var i=n(7),r=n(5),s=n(1);class o{constructor(t,e){this.email=t,this.password=e}}class a extends r.a{constructor(t,...e){super(t,{id:"authenticationForm",formClass:"form-signin needs-validation",listeners:e}),this.updateFields(),this._isInvalid=!1}getAuthenticationDTO(){let t=this.getData();return new o(t.email,t.password)}invalidFormData(){this._isInvalid=!0,this.updateFields()}_template(){let t=`\n        <div>\n            ${this._isInvalid?'\n                <div class="alert alert-warning" role="alert">\n                    E-mail ou senha invalidos!\n                </div>\n                ':""}\n\n\n            <div class="form-group">\n                <label for="email">Email</label>\n                <input type="email" min="3" max="20" class="form-control ${this._isInvalid?"is-invalid":""}" id="email" name="email" required>\n            </div>\n            <div class="form-group">\n                <label for="password">Senha</label>\n                <input type="password" min="3" max="20" class="form-control  ${this._isInvalid?"is-invalid":""}" id="password" name="password" required>\n            </div>\n\n            <button type='submit' class='btn btn-primary btn-lg btn-block'>Entrar</button>\n        </div>\n        `;return s.a.parse(t)}}var l=n(2),u=n(4);new class{constructor(){this._authService=new i.a,this._redirectAuthenticateds(),this._form=new a(".authenticationForm",new l.a("submit",t=>{t.preventDefault(),this.sigin()}))}_redirectAuthenticateds(){this._authService.hasValidToken().then(()=>{window.location.href="/customers.html"}).catch(t=>{})}sigin(){let t=this._form.getAuthenticationDTO(),e=new u.a;this._authService.authenticate(t).then(()=>{window.location.href="/customers.html",e.storeItem("email",t.email)}).catch(()=>{this._form.invalidFormData()})}}},4:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));n(11),n(7);class i{addToken(t,e){let n=`${t} ${e}`;window.localStorage.setItem("msaloonwbtoken",n)}storeItem(t,e){window.localStorage.setItem(t,e)}cleanToken(){window.localStorage.setItem("msaloonwbtoken",null)}get token(){return window.localStorage.getItem("msaloonwbtoken")}getStoredItem(t){return window.localStorage.getItem(t)}post(t,e){let n=this._buildTransactionDetails("POST",e);return this._buildFetchTransaction(t,n)}get(t){let e=this._buildTransactionDetails("GET",null);return this._buildFetchTransaction(t,e)}put(t,e){let n=this._buildTransactionDetails("PUT",e);return this._buildFetchTransaction(t,n)}delete(t){let e=this._buildTransactionDetails("DELETE",null);return fetch(t,e).then(t=>{if(t.ok)return!0;throw new Error("A transactional error has been happened.")})}_buildTransactionHeaders(){return new Headers({"Content-type":"Application/json",Authorization:this.token})}_buildTransactionDetails(t,e){return{method:t,body:e,headers:this._buildTransactionHeaders()}}_buildFetchTransaction(t,e){return fetch(t,e).then(t=>{if(t.ok)return t.json().then(t=>t).catch(t=>!0);throw new Error("A transactional error has been happened.")})}}},5:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(0);class r extends i.a{updateFields(){document.querySelector(this._tag+" .fields").innerHTML="",document.querySelector(this._tag+" .fields").appendChild(this._template())}submit(){document.querySelector(this._tag).submit()}reset(){document.querySelector(this._tag).reset()}getData(){let t=[];return $(this._tag).serializeArray().forEach(e=>{t[e.name]=e.value}),t}getDataAsParams(){return $(this._tag).serialize()}_init(){super._init(),this._info.initialContent&&this._component.querySelector(".fields").appendChild(this._info.initialContent),this._info.buttons&&this._info.initialButtons&&this._info.initialButtons.forEach(t=>this._component.querySelector(".buttons").appendChild(t))}_base(t){return`\n        <form id=${t.id} ${t.formClass?`class='${t.formClass}'`:""}>\n           <div class='fields'></div>\n           <div class='buttons'>\n                ${t.defaultButtons?'\n                <button type="submit" class="btn btn-primary">Salvar</button>\n                <button type="reset" class="btn btn-secondary">Limpar</button>\n                ':""}\n           </div>\n        </form>\n        `}_template(){throw new Error("the method fieldsTempalte must be implemented")}}},7:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(4);class r{constructor(){this._serverURL="http://localhost:8080/auth",this._webtoken="msaloonwbtoken",this._http=new i.a}hasValidToken(){return this._http.get(this._serverURL)}authenticate(t){let e={method:"POST",body:JSON.stringify(t),headers:{"Content-type":"Application/json"}};return fetch(this._serverURL,e).then(t=>{if(t.ok&&200==t.status)return t.json();throw new Error("The signin data is not correct")}).then(t=>{this._http.addToken(t.type,t.token)})}logout(){this._http.cleanToken()}redirectToLoginPage(){window.location.href="/login.html"}}}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvQ29tcG9uZW50LmpzIiwid2VicGFjazovLy8uL3NyYy9oZWxwZXJzL0RPTVBhcnNlclV0aWwuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvTGlzdGVuZXJBY3Rpb24uanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2R0b3MvQXV0aGVudGljYXRpb25EVE8uanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3ZpZXdzL0F1dGhlbnRpY2F0aW9uRm9ybS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvYXV0aGVudGljYXRpb24uanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbnRyb2xsZXJzL0F1dGhlbnRpY2F0aW9uQ29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaGVscGVycy9IdHRwSGVscGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL0Zvcm0uanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3NlcnZpY2VzL0F1dGhlbnRpY2F0aW9uVG9rZW5TZXJ2aWNlLmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiQ29tcG9uZW50IiwicGFyZW50U2VsZWN0b3IiLCJpbmZvIiwidGhpcyIsIl9jb21wb25lbnQiLCJwYXJzZSIsIl9iYXNlIiwiX3RhZyIsImlkIiwiX3BhcmVudFNlbGVjdG9yIiwiX2luZm8iLCJfaW5pdCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImFwcGVuZENoaWxkIiwiX2luaXRMaXN0ZW5lcnMiLCJsaXN0ZW5lcnMiLCJmb3JFYWNoIiwibGlzdGVuZXIiLCJhZGRFdmVudExpc3RlbmVyIiwidHlwZSIsImFjdGlvbiIsIkVycm9yIiwiRE9NUGFyc2VyVXRpbCIsImh0bWxUZXh0IiwiRE9NUGFyc2VyIiwicGFyc2VGcm9tU3RyaW5nIiwiZG9jdW1lbnRFbGVtZW50IiwiZmlyc3RDaGlsZCIsIkxpc3RlbmVyQWN0aW9uIiwiX3R5cGUiLCJfYWN0aW9uIiwiQXV0aGVudGljYXRpb25EVE8iLCJlbWFpbCIsInBhc3N3b3JkIiwiRm9ybSIsInN1cGVyIiwidXBkYXRlRmllbGRzIiwiX2lzSW52YWxpZCIsImRhdGEiLCJnZXREYXRhIiwidGVtcGxhdGUiLCJfYXV0aFNlcnZpY2UiLCJBdXRoZW50aWNhdGlvblRva2VuU2VydmljZSIsIl9yZWRpcmVjdEF1dGhlbnRpY2F0ZWRzIiwiX2Zvcm0iLCJldmVudCIsInByZXZlbnREZWZhdWx0Iiwic2lnaW4iLCJoYXNWYWxpZFRva2VuIiwidGhlbiIsIndpbmRvdyIsImxvY2F0aW9uIiwiaHJlZiIsImNhdGNoIiwiZXJyb3IiLCJkdG8iLCJnZXRBdXRoZW50aWNhdGlvbkRUTyIsImh0dHAiLCJIdHRwSGVscGVyIiwiYXV0aGVudGljYXRlIiwic3RvcmVJdGVtIiwiaW52YWxpZEZvcm1EYXRhIiwidG9rZW4iLCJsb2NhbFN0b3JhZ2UiLCJzZXRJdGVtIiwibGFiZWwiLCJnZXRJdGVtIiwiZW5kcG9pbnQiLCJ0cmFuc2FjdGlvbkRldGFpbHMiLCJfYnVpbGRUcmFuc2FjdGlvbkRldGFpbHMiLCJfYnVpbGRGZXRjaFRyYW5zYWN0aW9uIiwiZmV0Y2giLCJyZXMiLCJvayIsIkhlYWRlcnMiLCJtZXRob2QiLCJfYnVpbGRUcmFuc2FjdGlvbkhlYWRlcnMiLCJqc29uIiwiZXJyIiwiaW5uZXJIVE1MIiwiX3RlbXBsYXRlIiwic3VibWl0IiwicmVzZXQiLCIkIiwic2VyaWFsaXplQXJyYXkiLCJpbnB1dCIsInNlcmlhbGl6ZSIsImluaXRpYWxDb250ZW50IiwiYnV0dG9ucyIsImluaXRpYWxCdXR0b25zIiwiYnV0dG9uIiwiZm9ybUNsYXNzIiwiZGVmYXVsdEJ1dHRvbnMiLCJfc2VydmVyVVJMIiwiX3dlYnRva2VuIiwiX2h0dHAiLCJhdXRoRFRPIiwiSlNPTiIsInN0cmluZ2lmeSIsInN0YXR1cyIsImFkZFRva2VuIiwiY2xlYW5Ub2tlbiJdLCJtYXBwaW5ncyI6ImFBQ0UsSUFBSUEsRUFBbUIsR0FHdkIsU0FBU0MsRUFBb0JDLEdBRzVCLEdBQUdGLEVBQWlCRSxHQUNuQixPQUFPRixFQUFpQkUsR0FBVUMsUUFHbkMsSUFBSUMsRUFBU0osRUFBaUJFLEdBQVksQ0FDekNHLEVBQUdILEVBQ0hJLEdBQUcsRUFDSEgsUUFBUyxJQVVWLE9BTkFJLEVBQVFMLEdBQVVNLEtBQUtKLEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVNGLEdBRy9ERyxFQUFPRSxHQUFJLEVBR0pGLEVBQU9ELFFBS2ZGLEVBQW9CUSxFQUFJRixFQUd4Qk4sRUFBb0JTLEVBQUlWLEVBR3hCQyxFQUFvQlUsRUFBSSxTQUFTUixFQUFTUyxFQUFNQyxHQUMzQ1osRUFBb0JhLEVBQUVYLEVBQVNTLElBQ2xDRyxPQUFPQyxlQUFlYixFQUFTUyxFQUFNLENBQUVLLFlBQVksRUFBTUMsSUFBS0wsS0FLaEVaLEVBQW9Ca0IsRUFBSSxTQUFTaEIsR0FDWCxvQkFBWGlCLFFBQTBCQSxPQUFPQyxhQUMxQ04sT0FBT0MsZUFBZWIsRUFBU2lCLE9BQU9DLFlBQWEsQ0FBRUMsTUFBTyxXQUU3RFAsT0FBT0MsZUFBZWIsRUFBUyxhQUFjLENBQUVtQixPQUFPLEtBUXZEckIsRUFBb0JzQixFQUFJLFNBQVNELEVBQU9FLEdBRXZDLEdBRFUsRUFBUEEsSUFBVUYsRUFBUXJCLEVBQW9CcUIsSUFDL0IsRUFBUEUs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LE1BQU1OLEVBQUswRixVQUFZLFVBQVUxRixFQUFLMEYsYUFBZSxpR0FHM0QxRixFQUFLMkYsZUFBaUIsb0xBR3BCLG1EQU1oQixZQUNJLE1BQU0sSUFBSXZFLE1BQU0sb0QsK0JDbEV4Qiw2Q0FFZSxNQUFNcUIsRUFDakIsY0FDSXhDLEtBQUsyRixXQUFhLDZCQUNsQjNGLEtBQUs0RixVQUFZLGlCQUVqQjVGLEtBQUs2RixNQUFRLElBQUksSUFHckIsZ0JBQ0ksT0FBTzdGLEtBQUs2RixNQUFNbkgsSUFBSXNCLEtBQUsyRixZQUcvQixhQUFhRyxHQUNULElBQUk1QixFQUFxQixDQUNyQixPQUFVLE9BQ1YsS0FBUTZCLEtBQUtDLFVBQVVGLEdBQ3ZCLFFBQVcsQ0FDUCxlQUFnQixxQkFJeEIsT0FBT3pCLE1BQU1yRSxLQUFLMkYsV0FBWXpCLEdBQ3pCbkIsS0FBS3VCLElBQ0YsR0FBSUEsRUFBSUMsSUFBb0IsS0FBZEQsRUFBSTJCLE9BQ2QsT0FBTzNCLEVBQUlLLE9BRWYsTUFBTSxJQUFJeEQsTUFBTSxvQ0FDakI0QixLQUFLWCxJQUNKcEMsS0FBSzZGLE1BQU1LLFNBQVM5RCxFQUFLbkIsS0FBTW1CLEVBQUt3QixTQUloRCxTQUNJNUQsS0FBSzZGLE1BQU1NLGFBR2Ysc0JBQ0luRCxPQUFPQyxTQUFTQyxLQUFPIiwiZmlsZSI6ImF1dGhlbnRpY2F0aW9uLmJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAzNik7XG4iLCJpbXBvcnQgRE9NUGFyc2VyVXRpbCBmcm9tIFwiLi4vaGVscGVycy9ET01QYXJzZXJVdGlsXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb21wb25lbnQge1xyXG4gICAgY29uc3RydWN0b3IocGFyZW50U2VsZWN0b3IsIGluZm89e30pIHtcclxuICAgICAgICB0aGlzLl9jb21wb25lbnQgPSBET01QYXJzZXJVdGlsLnBhcnNlKHRoaXMuX2Jhc2UoaW5mbykpO1xyXG4gICAgICAgIHRoaXMuX3RhZyA9IGAjJHtpbmZvLmlkfWA7XHJcbiAgICAgICAgdGhpcy5fcGFyZW50U2VsZWN0b3IgPSBwYXJlbnRTZWxlY3RvcjtcclxuICAgICAgICB0aGlzLl9pbmZvID0gaW5mbztcclxuXHJcbiAgICAgICAgdGhpcy5faW5pdCgpO1xyXG5cclxuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX3BhcmVudFNlbGVjdG9yKS5hcHBlbmRDaGlsZCh0aGlzLl9jb21wb25lbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIF9pbml0KCkge1xyXG4gICAgICAgIHRoaXMuX2luaXRMaXN0ZW5lcnModGhpcy5faW5mby5saXN0ZW5lcnMpO1xyXG4gICAgfVxyXG5cclxuICAgIF9pbml0TGlzdGVuZXJzKGxpc3RlbmVycykge1xyXG4gICAgICAgIGlmIChsaXN0ZW5lcnMpIHtcclxuICAgICAgICAgICAgbGlzdGVuZXJzLmZvckVhY2gobGlzdGVuZXIgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY29tcG9uZW50LmFkZEV2ZW50TGlzdGVuZXIobGlzdGVuZXIudHlwZSwgbGlzdGVuZXIuYWN0aW9uKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9iYXNlKGluZm8pIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3RoZSBtZXRob2QgZmllbGRzVGVtcGFsdGUgbXVzdCBiZSBpbXBsZW1lbnRlZCcpO1xyXG4gICAgfVxyXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRE9NUGFyc2VyVXRpbCB7XHJcbiAgICBzdGF0aWMgcGFyc2UoaHRtbFRleHQpIHtcclxuICAgICAgICByZXR1cm4gbmV3IERPTVBhcnNlcigpLnBhcnNlRnJvbVN0cmluZyhodG1sVGV4dCwgJ3RleHQvaHRtbCcpLmRvY3VtZW50RWxlbWVudC5xdWVyeVNlbGVjdG9yKGBib2R5YCkuZmlyc3RDaGlsZDtcclxuICAgIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIExpc3RlbmVyQWN0aW9uIHtcclxuICAgIGNvbnN0cnVjdG9yKHR5cGUsIGFjdGlvbikge1xyXG4gICAgICAgIHRoaXMuX3R5cGUgPSB0eXBlO1xyXG4gICAgICAgIHRoaXMuX2FjdGlvbiA9IGFjdGlvbjtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgdHlwZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fdHlwZTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgYWN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9hY3Rpb247XHJcbiAgICB9XHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBdXRoZW50aWNhdGlvbkRUTyB7XHJcbiAgICBjb25zdHJ1Y3RvcihlbWFpbCwgcGFzc3dvcmQpIHtcclxuICAgICAgICB0aGlzLmVtYWlsID0gZW1haWw7XHJcbiAgICAgICAgdGhpcy5wYXNzd29yZCA9IHBhc3N3b3JkO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IEZvcm0gZnJvbSAnLi4vY29tcG9uZW50cy9Gb3JtJztcclxuaW1wb3J0IERPTVBhcnNlclV0aWwgZnJvbSAnLi4vaGVscGVycy9ET01QYXJzZXJVdGlsJztcclxuaW1wb3J0IEF1dGhlbnRpY2F0aW9uRFRPIGZyb20gJy4uL2R0b3MvQXV0aGVudGljYXRpb25EVE8nO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXV0aGVudGljYXRpb25Gb3JtIGV4dGVuZHMgRm9ybSB7XHJcbiAgICBjb25zdHJ1Y3RvcihwYXJlbnRTZWxlY3RvciwgLi4ubGlzdGVuZXJzKSB7XHJcbiAgICAgICAgc3VwZXIocGFyZW50U2VsZWN0b3IsIHtcclxuICAgICAgICAgICAgJ2lkJzogJ2F1dGhlbnRpY2F0aW9uRm9ybScsXHJcbiAgICAgICAgICAgICdmb3JtQ2xhc3MnOiAnZm9ybS1zaWduaW4gbmVlZHMtdmFsaWRhdGlvbicsXHJcbiAgICAgICAgICAgIGxpc3RlbmVyc1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLnVwZGF0ZUZpZWxkcygpO1xyXG4gICAgICAgIHRoaXMuX2lzSW52YWxpZCA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEF1dGhlbnRpY2F0aW9uRFRPKCkge1xyXG4gICAgICAgIGxldCBkYXRhID0gdGhpcy5nZXREYXRhKCk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBBdXRoZW50aWNhdGlvbkRUTyhkYXRhWydlbWFpbCddLCBkYXRhWydwYXNzd29yZCddKTtcclxuICAgIH1cclxuXHJcbiAgICBpbnZhbGlkRm9ybURhdGEoKSB7XHJcbiAgICAgICAgdGhpcy5faXNJbnZhbGlkID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnVwZGF0ZUZpZWxkcygpO1xyXG4gICAgfVxyXG5cclxuICAgIF90ZW1wbGF0ZSgpIHtcclxuICAgICAgICBsZXQgdGVtcGxhdGUgPSBgXHJcbiAgICAgICAgPGRpdj5cclxuICAgICAgICAgICAgJHt0aGlzLl9pc0ludmFsaWQgPyBcclxuICAgICAgICAgICAgICAgIGBcclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC13YXJuaW5nXCIgcm9sZT1cImFsZXJ0XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgRS1tYWlsIG91IHNlbmhhIGludmFsaWRvcyFcclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgYCA6ICcnfVxyXG5cclxuXHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJmb3JtLWdyb3VwXCI+XHJcbiAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPVwiZW1haWxcIj5FbWFpbDwvbGFiZWw+XHJcbiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cImVtYWlsXCIgbWluPVwiM1wiIG1heD1cIjIwXCIgY2xhc3M9XCJmb3JtLWNvbnRyb2wgJHt0aGlzLl9pc0ludmFsaWQgPyAnaXMtaW52YWxpZCcgOiAnJ31cIiBpZD1cImVtYWlsXCIgbmFtZT1cImVtYWlsXCIgcmVxdWlyZWQ+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZm9ybS1ncm91cFwiPlxyXG4gICAgICAgICAgICAgICAgPGxhYmVsIGZvcj1cInBhc3N3b3JkXCI+U2VuaGE8L2xhYmVsPlxyXG4gICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJwYXNzd29yZFwiIG1pbj1cIjNcIiBtYXg9XCIyMFwiIGNsYXNzPVwiZm9ybS1jb250cm9sICAke3RoaXMuX2lzSW52YWxpZCA/ICdpcy1pbnZhbGlkJyA6ICcnfVwiIGlkPVwicGFzc3dvcmRcIiBuYW1lPVwicGFzc3dvcmRcIiByZXF1aXJlZD5cclxuICAgICAgICAgICAgPC9kaXY+XHJcblxyXG4gICAgICAgICAgICA8YnV0dG9uIHR5cGU9J3N1Ym1pdCcgY2xhc3M9J2J0biBidG4tcHJpbWFyeSBidG4tbGcgYnRuLWJsb2NrJz5FbnRyYXI8L2J1dHRvbj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgICBgO1xyXG5cclxuICAgICAgICByZXR1cm4gRE9NUGFyc2VyVXRpbC5wYXJzZSh0ZW1wbGF0ZSk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgQXV0aGVudGljYXRpb25Db250cm9sbGVyIGZyb20gXCIuL2NvbnRyb2xsZXJzL0F1dGhlbnRpY2F0aW9uQ29udHJvbGxlclwiO1xyXG5cclxubGV0IGNvbnRyb2xsZXIgPSBuZXcgQXV0aGVudGljYXRpb25Db250cm9sbGVyKCk7IiwiaW1wb3J0IEF1dGhlbnRpY2F0aW9uVG9rZW5TZXJ2aWNlIGZyb20gXCIuLi9zZXJ2aWNlcy9BdXRoZW50aWNhdGlvblRva2VuU2VydmljZVwiO1xyXG5pbXBvcnQgQXV0aGVudGljYXRpb25Gb3JtIGZyb20gXCIuLi92aWV3cy9BdXRoZW50aWNhdGlvbkZvcm1cIjtcclxuaW1wb3J0IExpc3RlbmVyQWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL0xpc3RlbmVyQWN0aW9uXCI7XHJcbmltcG9ydCBIdHRwSGVscGVyIGZyb20gXCIuLi9oZWxwZXJzL0h0dHBIZWxwZXJcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEF1dGhlbnRpY2F0aW9uQ29udHJvbGxlciB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLl9hdXRoU2VydmljZSA9IG5ldyBBdXRoZW50aWNhdGlvblRva2VuU2VydmljZSgpO1xyXG4gICAgICAgIHRoaXMuX3JlZGlyZWN0QXV0aGVudGljYXRlZHMoKTtcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLl9mb3JtID0gbmV3IEF1dGhlbnRpY2F0aW9uRm9ybSgnLmF1dGhlbnRpY2F0aW9uRm9ybScsIFxyXG4gICAgICAgICAgICBuZXcgTGlzdGVuZXJBY3Rpb24oJ3N1Ym1pdCcsIGV2ZW50ID0+IHtcclxuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNpZ2luKCk7XHJcbiAgICAgICAgICAgIH0pKTtcclxuICAgIH1cclxuXHJcbiAgICBfcmVkaXJlY3RBdXRoZW50aWNhdGVkcygpIHtcclxuICAgICAgICB0aGlzLl9hdXRoU2VydmljZS5oYXNWYWxpZFRva2VuKClcclxuICAgICAgICAgICAgLnRoZW4oKCkgPT4ge3dpbmRvdy5sb2NhdGlvbi5ocmVmID0gJy9jdXN0b21lcnMuaHRtbCd9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4ge30pO1xyXG4gICAgfVxyXG5cclxuICAgIHNpZ2luKCkge1xyXG4gICAgICAgIGxldCBkdG8gPSB0aGlzLl9mb3JtLmdldEF1dGhlbnRpY2F0aW9uRFRPKCk7XHJcbiAgICAgICAgbGV0IGh0dHAgPSBuZXcgSHR0cEhlbHBlcigpO1xyXG4gICAgICAgIHRoaXMuX2F1dGhTZXJ2aWNlLmF1dGhlbnRpY2F0ZShkdG8pXHJcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJy9jdXN0b21lcnMuaHRtbCc7XHJcbiAgICAgICAgICAgICAgICBodHRwLnN0b3JlSXRlbSgnZW1haWwnLCBkdG8uZW1haWwpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZm9ybS5pbnZhbGlkRm9ybURhdGEoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgRmllbGRFcnJvciBmcm9tIFwiLi4vZm9ybXMvRmllbGRFcnJvclwiO1xyXG5pbXBvcnQgQXV0aGVudGljYXRpb25Ub2tlblNlcnZpY2UgZnJvbSBcIi4uL3NlcnZpY2VzL0F1dGhlbnRpY2F0aW9uVG9rZW5TZXJ2aWNlXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBIdHRwSGVscGVyIHtcclxuICAgIGFkZFRva2VuKHR5cGUsIHRva2VuKSB7XHJcbiAgICAgICAgbGV0IGRhdGEgPSBgJHt0eXBlfSAke3Rva2VufWA7XHJcbiAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdtc2Fsb29ud2J0b2tlbicsIGRhdGEpO1xyXG4gICAgfVxyXG5cclxuICAgIHN0b3JlSXRlbShsYWJlbCwgdmFsdWUpIHtcclxuICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0obGFiZWwsIHZhbHVlKTtcclxuICAgIH1cclxuXHJcbiAgICBjbGVhblRva2VuKCkge1xyXG4gICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnbXNhbG9vbndidG9rZW4nLCBudWxsKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgdG9rZW4oKSB7XHJcbiAgICAgICAgcmV0dXJuIHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbXNhbG9vbndidG9rZW4nKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRTdG9yZWRJdGVtKGxhYmVsKSB7XHJcbiAgICAgICAgcmV0dXJuIHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShsYWJlbCk7XHJcbiAgICB9XHJcblxyXG4gICAgcG9zdChlbmRwb2ludCwgZGF0YSkge1xyXG4gICAgICAgIGxldCB0cmFuc2FjdGlvbkRldGFpbHMgPSB0aGlzLl9idWlsZFRyYW5zYWN0aW9uRGV0YWlscygnUE9TVCcsIGRhdGEpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9idWlsZEZldGNoVHJhbnNhY3Rpb24oZW5kcG9pbnQsIHRyYW5zYWN0aW9uRGV0YWlscyk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0KGVuZHBvaW50KSB7XHJcbiAgICAgICAgbGV0IHRyYW5zYWN0aW9uRGV0YWlscyA9IHRoaXMuX2J1aWxkVHJhbnNhY3Rpb25EZXRhaWxzKCdHRVQnLCBudWxsKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5fYnVpbGRGZXRjaFRyYW5zYWN0aW9uKGVuZHBvaW50LCB0cmFuc2FjdGlvbkRldGFpbHMpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1dChlbmRwb2ludCwgZGF0YSkge1xyXG4gICAgICAgIGxldCB0cmFuc2FjdGlvbkRldGFpbHMgPSB0aGlzLl9idWlsZFRyYW5zYWN0aW9uRGV0YWlscygnUFVUJywgZGF0YSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2J1aWxkRmV0Y2hUcmFuc2FjdGlvbihlbmRwb2ludCwgdHJhbnNhY3Rpb25EZXRhaWxzKTtcclxuICAgIH1cclxuXHJcbiAgICBkZWxldGUoZW5kcG9pbnQpIHtcclxuICAgICAgICBsZXQgdHJhbnNhY3Rpb25EZXRhaWxzID0gdGhpcy5fYnVpbGRUcmFuc2FjdGlvbkRldGFpbHMoJ0RFTEVURScsIG51bGwpO1xyXG4gICAgICAgIHJldHVybiBmZXRjaChlbmRwb2ludCwgdHJhbnNhY3Rpb25EZXRhaWxzKVxyXG4gICAgICAgICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQSB0cmFuc2FjdGlvbmFsIGVycm9yIGhhcyBiZWVuIGhhcHBlbmVkLicpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBfYnVpbGRUcmFuc2FjdGlvbkhlYWRlcnMoKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBIZWFkZXJzKHtcclxuICAgICAgICAgICAgJ0NvbnRlbnQtdHlwZSc6ICdBcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiB0aGlzLnRva2VuXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgX2J1aWxkVHJhbnNhY3Rpb25EZXRhaWxzKG1ldGhvZCwgZGF0YSkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICdtZXRob2QnOiBtZXRob2QsXHJcbiAgICAgICAgICAgICdib2R5JzogZGF0YSxcclxuICAgICAgICAgICAgJ2hlYWRlcnMnOiB0aGlzLl9idWlsZFRyYW5zYWN0aW9uSGVhZGVycygpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9idWlsZEZldGNoVHJhbnNhY3Rpb24oZW5kcG9pbnQsIHRyYW5zYWN0aW9uRGV0YWlscykge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChlbmRwb2ludCwgdHJhbnNhY3Rpb25EZXRhaWxzKVxyXG4gICAgICAgICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMuanNvbigpLnRoZW4oZGF0YSA9PiAgZGF0YSkuY2F0Y2goZXJyID0+IHRydWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0EgdHJhbnNhY3Rpb25hbCBlcnJvciBoYXMgYmVlbiBoYXBwZW5lZC4nKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgQ29tcG9uZW50IGZyb20gXCIuL0NvbXBvbmVudFwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybSBleHRlbmRzIENvbXBvbmVudHtcclxuICAgICAvKiBcclxuICAgICAgICBJbmZvIHtcclxuICAgICAgICAgICAgXCJpZFwiOiBmb3JtIGlkIGF0dHJpYnV0ZSxcclxuICAgICAgICAgICAgXCJmb3JtQ2xhc3NcIjogZm9ybSBjbGFzcyBleC4gJ2Zvcm0taG9yaXpvbnRhbCcsXHJcbiAgICAgICAgICAgIFwiaW5pdGlhbENvbnRlbnRcIjogZm9ybSBmaWVsZHMsXHJcbiAgICAgICAgICAgIFwiYnV0dG9uc1wiOiB0cnVlL2ZhbHNlIGZvciBmb3JtIGJ1dHRvbnMsXHJcbiAgICAgICAgICAgIFwiaW5pdGlhbEJ1dHRvbnNcIjogZm9yIGluaXRpYWwgYnV0dG9ucyBjb250ZW50LFxyXG4gICAgICAgICAgICBcImRlZmF1bHRCdXR0b25zXCI6IHRydWUvZmFsc2UgZm9yIGRlZmF1bHQgYnV0dG9ucyxcclxuICAgICAgICAgICAgXCJsaXN0ZW5lcnNcIjogbGlzdGVuZXJzIGZvciBmb3JtIGFjdGlvbnNcclxuICAgICAgICB9XHJcbiAgICAqL1xyXG4gICAgdXBkYXRlRmllbGRzKCkge1xyXG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCR7dGhpcy5fdGFnfSAuZmllbGRzYCkuaW5uZXJIVE1MID0gJyc7XHJcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgJHt0aGlzLl90YWd9IC5maWVsZHNgKS5hcHBlbmRDaGlsZCh0aGlzLl90ZW1wbGF0ZSgpKTtcclxuICAgIH1cclxuXHJcbiAgICBzdWJtaXQoKSB7XHJcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl90YWcpLnN1Ym1pdCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlc2V0KCkge1xyXG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fdGFnKS5yZXNldCgpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldERhdGEoKSB7XHJcbiAgICAgICAgbGV0IGRhdGEgPSBbXTtcclxuICAgICAgICAkKHRoaXMuX3RhZykuc2VyaWFsaXplQXJyYXkoKS5mb3JFYWNoKGlucHV0ID0+IHtcclxuICAgICAgICAgICAgZGF0YVtpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgfVxyXG5cclxuICAgIGdldERhdGFBc1BhcmFtcygpIHtcclxuICAgICAgICByZXR1cm4gJCh0aGlzLl90YWcpLnNlcmlhbGl6ZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIF9pbml0KCkge1xyXG4gICAgICAgIHN1cGVyLl9pbml0KCk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9pbmZvLmluaXRpYWxDb250ZW50KSBcclxuICAgICAgICAgICAgdGhpcy5fY29tcG9uZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZmllbGRzXCIpLmFwcGVuZENoaWxkKHRoaXMuX2luZm8uaW5pdGlhbENvbnRlbnQpO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5faW5mby5idXR0b25zICYmIHRoaXMuX2luZm8uaW5pdGlhbEJ1dHRvbnMpXHJcbiAgICAgICAgICAgIHRoaXMuX2luZm8uaW5pdGlhbEJ1dHRvbnMuZm9yRWFjaChidXR0b24gPT4gXHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jb21wb25lbnQucXVlcnlTZWxlY3RvcihcIi5idXR0b25zXCIpLmFwcGVuZENoaWxkKGJ1dHRvbikpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBfYmFzZShpbmZvKSB7XHJcbiAgICAgICAgcmV0dXJuIGBcclxuICAgICAgICA8Zm9ybSBpZD0ke2luZm8uaWR9ICR7aW5mby5mb3JtQ2xhc3MgPyBgY2xhc3M9JyR7aW5mby5mb3JtQ2xhc3N9J2AgOiAnJ30+XHJcbiAgICAgICAgICAgPGRpdiBjbGFzcz0nZmllbGRzJz48L2Rpdj5cclxuICAgICAgICAgICA8ZGl2IGNsYXNzPSdidXR0b25zJz5cclxuICAgICAgICAgICAgICAgICR7aW5mby5kZWZhdWx0QnV0dG9ucyA/IGBcclxuICAgICAgICAgICAgICAgIDxidXR0b24gdHlwZT1cInN1Ym1pdFwiIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5XCI+U2FsdmFyPC9idXR0b24+XHJcbiAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9XCJyZXNldFwiIGNsYXNzPVwiYnRuIGJ0bi1zZWNvbmRhcnlcIj5MaW1wYXI8L2J1dHRvbj5cclxuICAgICAgICAgICAgICAgIGAgOiAnJ31cclxuICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L2Zvcm0+XHJcbiAgICAgICAgYDtcclxuICAgIH1cclxuXHJcbiAgICBfdGVtcGxhdGUoKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCd0aGUgbWV0aG9kIGZpZWxkc1RlbXBhbHRlIG11c3QgYmUgaW1wbGVtZW50ZWQnKTtcclxuICAgIH1cclxufSIsImltcG9ydCBIdHRwSGVscGVyIGZyb20gXCIuLi9oZWxwZXJzL0h0dHBIZWxwZXJcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEF1dGhlbnRpY2F0aW9uVG9rZW5TZXJ2aWNlIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMuX3NlcnZlclVSTCA9IGAke1NFUlZJQ0VfVVJMfS9hdXRoYDtcclxuICAgICAgICB0aGlzLl93ZWJ0b2tlbiA9ICdtc2Fsb29ud2J0b2tlbic7XHJcblxyXG4gICAgICAgIHRoaXMuX2h0dHAgPSBuZXcgSHR0cEhlbHBlcigpO1xyXG4gICAgfVxyXG5cclxuICAgIGhhc1ZhbGlkVG9rZW4oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2h0dHAuZ2V0KHRoaXMuX3NlcnZlclVSTCk7XHJcbiAgICB9XHJcblxyXG4gICAgYXV0aGVudGljYXRlKGF1dGhEVE8pIHtcclxuICAgICAgICBsZXQgdHJhbnNhY3Rpb25EZXRhaWxzID0ge1xyXG4gICAgICAgICAgICAnbWV0aG9kJzogJ1BPU1QnLFxyXG4gICAgICAgICAgICAnYm9keSc6IEpTT04uc3RyaW5naWZ5KGF1dGhEVE8pLFxyXG4gICAgICAgICAgICAnaGVhZGVycyc6IHtcclxuICAgICAgICAgICAgICAgICdDb250ZW50LXR5cGUnOiAnQXBwbGljYXRpb24vanNvbidcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZldGNoKHRoaXMuX3NlcnZlclVSTCwgdHJhbnNhY3Rpb25EZXRhaWxzKVxyXG4gICAgICAgICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlcy5vayAmJiByZXMuc3RhdHVzID09IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhlIHNpZ25pbiBkYXRhIGlzIG5vdCBjb3JyZWN0XCIpO1xyXG4gICAgICAgICAgICB9KS50aGVuKGRhdGEgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5faHR0cC5hZGRUb2tlbihkYXRhLnR5cGUsIGRhdGEudG9rZW4pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBsb2dvdXQoKSB7XHJcbiAgICAgICAgdGhpcy5faHR0cC5jbGVhblRva2VuKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVkaXJlY3RUb0xvZ2luUGFnZSgpIHtcclxuICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvbG9naW4uaHRtbCdcclxuICAgIH0gIFxyXG5cclxufSJdLCJzb3VyY2VSb290IjoiIn0=